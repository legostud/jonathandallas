window.RWJF=window.RWJF||{},RWJF.ui={initialize:function(){"use strict";var a=$("body").data("controller");a.length&&RWJF.ui[a].initialize()}},function(a){a(function(){RWJF.ui.initialize()})}(jQuery),RWJF.ui.NationalDirectory=function(){"use strict";var a={};return a.RegionSelector={$el:$("#region-selector"),displayRegion:function(b){var c=$("#region-details").removeClass("show"),d=$("#region-image");a.ReportsTable.changeCurrent(b.region.toLowerCase().replace(" ","-")),d.find("li").eq(b.id-1).find("img").attr("src",b.image),d.find("ul").animate({marginTop:-d.find("ul").find("li").eq(b.id-1).position().top},500),setTimeout(function(){c.find(".title").html(b.title),c.find(".total-value").html(b.total),c.find(".region-value").html(b.value),c.addClass("show")},500)},initialize:function(){var b=a.RegionSelector.$el.find(".input"),c=[{id:1,region:"National",num_reports:2,title:"National Reports",total:"258 Total",value:"<span>21</span> in the US",image:"images/regions/usa.png"},{id:2,region:"New York",num_reports:5,title:"Public Health Care Quality Reports",total:"130 Total",value:"<span>28</span> in New York",image:"images/regions/new-york.png"}];b.select2({data:{results:c,text:function(a){return a.region}},formatResult:function(a){return a.region+" <span>"+a.num_reports+" Reports</span>"},formatSelection:function(a){return a.region},maximumSelectionSize:1,multiple:!0,placeholder:"Enter or select a region"}).on("select2-opening",function(){b.select2("data",null)}).on("change",function(){var b=$(this).select2("data")[0];a.RegionSelector.displayRegion(b)}),b.select2("val",b.data("default"))}},a.ReportsTable={$el:$("#reports-table"),changeCurrent:function(b){var c=a.ReportsTable.$el;c.find("tbody.current").html(c.find('tbody[data-region="'+b+'"]').html()),c.trigger("update")},initialize:function(){a.ReportsTable.$el.tablesorter({cssChildRow:"expandable-content",cssInfoBlock:"tbody:not(.current)",headers:{3:{sorter:!1}}}),$("body").on("click",".expandable-toggle",function(){var a=$(this).closest("tr");a.next(".expandable-content"),a.toggleClass("show")}),$(".disclaimer-toggle").on("click",function(a){a.preventDefault(),$(this).closest(".disclaimer").toggleClass("show")})}},a.initialize=function(){a.RegionSelector.initialize(),a.ReportsTable.initialize()},a}(),RWJF.ui.SignsOfProgress=function(a){"use strict";var b={},c=a(".progress-container"),d=c.find(".table-of-contents"),e=!1;return b.FixedItems=function(b,c){c=c||0,this.load=function(){b.each(function(){var b,c=a(this);c.is(".header-wrapper .article-header")||(b=c.wrap('<div class="header-wrapper" />'),b.parent().height(b.outerHeight()),a.data(b[0],"top",b.offset().top))})},this.scroll=function(){e&&b.each(function(e){var f,g=a(this),h=b.eq(e+1),i=b.eq(e-1),j=a.data(g[0],"top"),k=a("#map-container .maps > li"),l=a("#map-container .map-info > ul > li");j<=a(window).scrollTop()+c?(g.addClass("fixed"),d.find("li").removeClass("active"),d.find("li").eq(e).addClass("active"),k.removeClass("current"),f=g.closest(".map-article").attr("id"),k.each(function(){var b=a(this);f==b.attr("data-title")&&b.addClass("current")}),l.removeClass("current"),l.each(function(){var b=a(this);f==b.attr("data-title")&&b.addClass("current")}),h.length>0&&g.offset().top>=a.data(h[0],"top")-g.outerHeight()&&(g.addClass("absolute").css("top",a.data(h[0],"top")-g.outerHeight()),d.find("li").eq(e).removeClass("active"))):(g.removeClass("fixed"),d.find("li").eq(e).removeClass("active"),i.length>0&&a(window).scrollTop()+c<=a.data(g[0],"top")-i.outerHeight()&&i.removeClass("absolute").removeAttr("style"))})}},b.deviceInitialize=function(){var b=c.find(".map-articles"),d=b.find(".map-article");c.removeClass("map-stuck"),b.css("margin-top","auto"),d.find(".article-header").removeAttr("style").removeClass("fixed"),a(".header-wrapper").removeAttr("style"),e=!1,a(window).off("scroll")},b.desktopInitialize=function(){var f=c.find("#map-container"),g=c.find(".map-articles"),h=g.find(".map-article"),i=f.offset().top,j=new b.FixedItems(a(".article-header"),f.outerHeight());j.load(),a(window).on("scroll",function(){var b=a(window).scrollTop(),d=b>=i,k=g.offset().top+g.outerHeight()<=b+f.outerHeight()+120;j.scroll(),d&&!k?(e=!0,c.addClass("map-stuck"),g.css("margin-top",f.outerHeight())):(e=!1,c.removeClass("map-stuck"),g.css("margin-top","auto"),k&&h.find(".article-header").removeAttr("style"))}),a(".progress-scroll-down .intro").on("click",function(b){b.preventDefault();var c=a(".anchor-link").attr("href");c.length>1&&a("html, body").animate({scrollTop:a(c).offset().top},300)}),d.find(".header-link").on("click",function(b){b.preventDefault();var c=a(this).attr("href");c.length>1&&a("html, body").animate({scrollTop:a(c).offset().top-f.outerHeight()+1},300)}),d.find(".prev").off("click").on("click",function(a){a.preventDefault(),d.find(".active").prev("li").find("a").trigger("click")}),d.find(".next").off("click").on("click",function(a){a.preventDefault(),d.find(".active").next("li").find("a").trigger("click")})},b.initialize=function(){Modernizr.mq("all and (min-width: 1025px)")&&b.desktopInitialize(),a(window).on("resize",function(){Modernizr.mq("all and (max-width: 1024px")?(e=!1,b.deviceInitialize()):(e=!0,b.desktopInitialize())})},b}(jQuery);