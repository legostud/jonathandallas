<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Facebook Like button for Everest Poker promotions</title>

<link rel="stylesheet" type="text/css" href="include/global.css" />
</head>

<body>
<p>The SEO team requested we add Facebook Like buttons to all of the Promotion Pages on EverestPoker.fr.</p>
<p>The EverestPoker.fr site is built using Plone and the Promotions use a custom "promotion" content type</p>
<hr />
<p>First step was to create a viewlet to contain the Facebook code</p> 
<div class="code">&lt;div id=&quot;fb-root&quot;&gt;&lt;/div&gt;<br>
  &lt;span id=&quot;current-language&quot; tal:content=&quot;here/Language&quot; style=&quot;display:none;&quot;&gt;&lt;/span&gt;<br>
  &lt;script&gt;<br>
window.fbAsyncInit = function() {<br>
FB.init({appId: 'your app id', status: true, cookie: true,<br>
xfbml: true});<br>
};<br>
(function() {<br>
var locale = {da:'da_DK', de:'de_DE', el:'el_GR', en:'en_US', es:'es_LA', fi:'fi_FI', fr:'fr_FR', hu:'hu_HU', it:'it_IT', ja:'ja_JP', nl:'nl_NL', no:'nb_NO', pl:'pl_PL', pt:'pt_BR', sv:'sv_SE'};<br>
var lang = document.getElementById('current-language').innerHTML;<br>
var e = document.createElement('script'); e.async = true;<br>
e.src = document.location.protocol + '//connect.facebook.net/' + locale[lang] + '/all.js';<br>
document.getElementById('fb-root').appendChild(e);<br>
}());<br>
&lt;/script&gt;<br>
&lt;fb:like layout=&quot;standard&quot; show_faces=&quot;false&quot; tal:attributes=&quot;href string:${container/absolute_url}?adv=${here/facebook_like_id|PID}&quot; tal:define=&quot;PID string:M384F001&quot;&gt;&lt;/fb:like&gt;<br>
</div>
<p class="note">This code is designed to work in 15 different languages and contain a generic Partner ID (PID) that can be manually overwritten</p>
<hr />
<p>Second step is to add the required meta tags to the head section of site found in the "main_template"</p>
<div class="code">
  <p>&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;<br>
    xml:lang=&quot;en&quot;<br>
    lang=&quot;en&quot;<br>
    <span class="highlight">xmlns:og=&quot;http://ogp.me/ns#&quot;<br>
    xmlns:fb=&quot;http://www.facebook.com/2008/fbml&quot;</span><br>
    tal:define=&quot;lang language&quot;<br>
    tal:attributes=&quot;lang lang;<br>
  xml:lang lang&quot;&gt;</p>
  <p> &lt;meta tal:define=&quot;ep_title string:Everest Poker&quot; property=&quot;og:title&quot; tal:attributes=&quot;content here/Title|ep_title&quot; /&gt;<br>
&lt;meta property=&quot;og:type&quot; content=&quot;game&quot;/&gt;<br>
&lt;meta property=&quot;og:url&quot; tal:attributes=&quot;content string:${here/absolute_url}&quot; /&gt;<br>
&lt;meta property=&quot;og:image&quot; tal:attributes=&quot;content string:${here/absolute_url}/icon_image&quot; /&gt;<br>
    </p>
</div>
<hr />
<p>Third step is to register the viewlet in two files</p>
<p>Configure.zcml:</p>
<div class="code"> &lt;browser:viewlet<br>
name=&quot;evp.theme.facebook.like&quot;<br>
for=&quot;evp.site.content.interfaces.IPromotion&quot;<br>
manager=&quot;plone.app.layout.viewlets.interfaces.IBelowContentTitle&quot;<br>
template=&quot;templates/facebook_like.pt&quot;<br>
layer=&quot;..interfaces.IThemeSpecific&quot;<br>
permission=&quot;zope2.View&quot;<br>
/&gt;
</div>
<p>viewlets.xml</p>
<div class="code">
  <order manager="plone.belowcontenttitle" skinname="EVP Plone Theme"
         based-on="Plone Default">
    <viewlet name="evp.theme.facebook.like" insert-before="evp.theme.contentbanner" />
    <viewlet name="evp.theme.contentbanner" />  
  </order>  
</div>
<hr />
<p>The last step is to add a custom field to the Promotion content type for the Partner ID.
<div class="code"> 
atapi.StringField(<br>
name='facebook_like_id',<br>
required=False,<br>
widget=atapi.StringWidget(<br>
label=_(u&quot;Facebook Like Partner ID&quot;),<br>
description=_(u&quot;Adds a specific Partner ID to the like button&quot;),<br>
),<br>
)<br>
</div>
<hr />
<p>Below are screen shots of what the final product would have looked like (wasn't released because of Facebook policy in regards to gambling sites).</p>
<p><img src="PromoPageEnglish.png" /></p>
<p><img src="PromoPageDutch.png /></p>

</body>
</html>
